#!/bin/bash

# Elasticsearch settings
ELASTICSEARCH_HOST="your_elasticsearch_host"
ELASTICSEARCH_PORT="9200"
ELASTICSEARCH_USERNAME="your_elasticsearch_username"
ELASTICSEARCH_PASSWORD="your_elasticsearch_password"

# Index template settings
TEMPLATE_NAME="your_template_name"
INDEX_PATTERN="your_index_pattern"
MAPPING_FILE="path/to/your_mapping_file.json"
SETTINGS_FILE="path/to/your_settings_file.json"

# Elasticsearch API endpoint for index templates
TEMPLATE_ENDPOINT="_index_template"

# Load the mapping and settings from files
MAPPING=$(cat "$MAPPING_FILE")
SETTINGS=$(cat "$SETTINGS_FILE")

# Create the index template
curl -X PUT -u "$ELASTICSEARCH_USERNAME:$ELASTICSEARCH_PASSWORD" \
     "http://$ELASTICSEARCH_HOST:$ELASTICSEARCH_PORT/$TEMPLATE_ENDPOINT/$TEMPLATE_NAME" \
     -H 'Content-Type: application/json' \
     -d '
{
  "index_patterns": ["'"$INDEX_PATTERN"'"],
  "mappings": {
    "_source": {
      "enabled": true
    },
    "properties": '"$MAPPING"'
  },
  "settings": '"$SETTINGS"'
}
'

echo "Index template created: $TEMPLATE_NAME"
