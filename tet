from kafka.admin import KafkaAdminClient
from kafka import KafkaConsumer
import json

# Replace with your Kafka settings
bootstrap_servers = ['your_kafka_broker_1:9092', 'your_kafka_broker_2:9092']
consumer_group_id = 'your_consumer_group'

def get_consumer_group_details(bootstrap_servers, consumer_group_id):
    admin_client = KafkaAdminClient(bootstrap_servers=bootstrap_servers)

    consumer_group_details = admin_client.describe_consumer_groups([consumer_group_id])
    
    group_members = consumer_group_details[0].members
    
    consumers_info = []
    
    for member in group_members:
        member_info = {
            "consumer_id": member.member_id,
            "client_id": member.client_id,
            "host": member.client_host
        }
        consumers_info.append(member_info)
    
    return consumers_info

if __name__ == '__main__':
    consumer_group_info = get_consumer_group_details(bootstrap_servers, consumer_group_id)
    print(json.dumps(consumer_group_info, indent=4))
