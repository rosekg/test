import pandas as pd

# Read the CSV file into a DataFrame
data = {
    'jobname': ['Job1', 'Job2', 'Job3', 'Job5', 'job6', 'job7', 'job8'],
    'predecessor': ['jobx', 'Job1', 'Job1', 'Job2', 'jobx', 'job2', 'job5']
}
df = pd.DataFrame(data)

# Create an empty 'successor' column
df['successor'] = None

# Iterate through the rows to find the successors
for index, row in df.iterrows():
    # Get the jobname (current job)
    jobname = row['jobname']
    
    # Find all jobs where 'predecessor' is the current jobname
    successors = df[df['predecessor'] == jobname]['jobname'].tolist()
    
    # If there are successors, join them with '|' and update the 'successor' column
    if successors:
        df.at[index, 'successor'] = '|'.join(successors)
    else:
        df.at[index, 'successor'] = 'None'

# Display the final DataFrame
print(df[['jobname', 'predecessor', 'successor']])
