import pandas as pd

# Sample Input DataFrame
data = {'cola': ['ABC', 'DEF', 'ABC', 'GHI', 'DEF', 'GHI', 'JKL'],
        'colb': ['AAA', 'BBB', 'CCC', 'DDD', 'EEE', 'FFF', 'GGG']}
df = pd.DataFrame(data)

# Group by 'cola' and count the occurrences
cola_counts = df['cola'].value_counts()

# Update 'is_cola_shared' column based on whether 'cola' value is shared
df['is_cola_shared'] = df['cola'].apply(lambda x: 'yes' if cola_counts[x] > 1 else 'no')

# Create 'shared_colb_values' column containing lists of 'colb' values for shared 'cola'
df['shared_colb_values'] = df['cola'].apply(lambda x: df[df['cola'] == x]['colb'].tolist() if cola_counts[x] > 1 else [])

# Create 'shared_colb_values_count' column containing count of shared 'colb' values
df['shared_colb_values_count'] = df['shared_colb_values'].apply(lambda x: len(x))

# Display the updated DataFrame
print(df)
