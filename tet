from elasticsearch import Elasticsearch
from elasticsearch.helpers import reindex

# Connect to the Elasticsearch cluster
es = Elasticsearch(['http://localhost:9200'])

# Define the source and destination index names
source_index = 'source_index_name'
destination_index = 'destination_index_name'

# Define the reindex query
query = {
  "source": {
    "index": source_index
  },
  "dest": {
    "index": destination_index
  }
}

# Perform the reindex operation
response = reindex(es, body=query, request_timeout=600)

# Print the response
print(response)
