from elasticsearch import Elasticsearch

# Initialize the Elasticsearch client
es = Elasticsearch(['localhost:9200'])

# Get indices information using the cat.indices API
indices_info = es.cat.indices(format="json", h="index,store.size")

# Process the indices information to calculate total disk space consumed by each project
project_space = {}
for index_data in indices_info:
    index_name = index_data['index']
    store_size = index_data['store.size']
    project_name = index_name.split('_')[0]
    if project_name in project_space:
        project_space[project_name] += int(store_size)
    else:
        project_space[project_name] = int(store_size)

# Print the total disk space consumed by each project
for project, total_space in project_space.items():
    print(f"Project: {project}, Total Disk Space Consumed: {total_space} bytes")
