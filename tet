import json

# Assuming master_df is the final DataFrame after processing
mapping = {
    "mappings": {
        "properties": {}
    }
}

for column in master_df.columns:
    if master_df[column].dtype == 'int64':
        mapping["mappings"]["properties"][column] = {"type": "integer"}
    elif master_df[column].dtype == 'float64':
        mapping["mappings"]["properties"][column] = {"type": "float"}
    elif master_df[column].dtype == 'bool':
        mapping["mappings"]["properties"][column] = {"type": "boolean"}
    elif master_df[column].dtype == 'datetime64[ns]':
        mapping["mappings"]["properties"][column] = {"type": "date"}
    else:
        mapping["mappings"]["properties"][column] = {"type": "text"}

# Convert mapping to JSON
mapping_json = json.dumps(mapping, indent=4)
print(mapping_json)
