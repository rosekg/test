import json

# Assuming index_settings is the existing settings dictionary
index_settings = {
    "settings": {
        "number_of_shards": 1,
        "number_of_replicas": 0
    },
    "mappings": {
        "properties": {}
    }
}

# Iterate over columns in master_df to add mapping properties
for column in master_df.columns:
    if master_df[column].dtype == 'int64':
        index_settings["mappings"]["properties"][column] = {"type": "integer"}
    elif master_df[column].dtype == 'float64':
        index_settings["mappings"]["properties"][column] = {"type": "float"}
    elif master_df[column].dtype == 'bool':
        index_settings["mappings"]["properties"][column] = {"type": "boolean"}
    elif master_df[column].dtype == 'datetime64[ns]':
        index_settings["mappings"]["properties"][column] = {"type": "date"}
    else:
        index_settings["mappings"]["properties"][column] = {"type": "text"}

# Convert index_settings to JSON
index_settings_json = json.dumps(index_settings, indent=4)
print(index_settings_json)
