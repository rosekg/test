POST your_index_name/_update_by_query
{
  "query": {
    "range": {
      "end_time": {
        "gte": "now-1y/y"
      }
    }
  },
  "script": {
    "source": """
      if (ctx._source.containsKey('start_time') && ctx._source.containsKey('end_time')) {
        ZonedDateTime start = ZonedDateTime.parse(ctx._source.start_time);
        ZonedDateTime end = ZonedDateTime.parse(ctx._source.end_time);
        long durationInMinutes = java.time.Duration.between(start, end).toMinutes();
        ctx._source.job_duration_mins = durationInMinutes;
      }
    """,
    "lang": "painless"
  }
}
