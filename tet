from elasticsearch import Elasticsearch
from elasticsearch_sql import SQLClient

# Connect to Elasticsearch
es = Elasticsearch(hosts=['localhost'])

# Create an SQL client
sql_client = SQLClient(es)

# Execute an SQL query to select multiple columns, filter on date, and get distinct values
sql_query = """
SELECT ColA, DISTINCT(ColB)
FROM your_index
WHERE ColA >= '2021-01-01' AND ColA <= '2021-12-31'
GROUP BY ColA, ColB
"""
response = sql_client.execute(sql_query)

# Process the results
for hit in response:
    colA = hit['ColA']
    colB = hit['ColB']
    # Do something with the retrieved columns

# Close the SQL client
sql_client.close()
