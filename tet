#!/bin/bash

# Input CSV file
input_file="yourfile.csv"

# Temporary file
temp_file="temp.csv"

# Use awk to process the file
awk -F, '
BEGIN { OFS = "|" }
{
    # Loop through each field
    for (i = 1; i <= NF; i++) {
        # Replace commas inside quotes with semicolons
        gsub(/"[^"]*,[^"]*"/, function(m) { return gensub(/,/, ";", "g", m) }, $i)
        # Remove quotes
        gsub(/"/, "", $i)
        # Replace remaining commas with pipes
        gsub(/,/, "|", $i)
    }
    print
}' "$input_file" > "$temp_file"

# Overwrite the original file with the modified data
mv "$temp_file" "$input_file"
