import pandas as pd

# Read the Excel file
df = pd.read_excel('input_file.xlsx')

# Ensure all columns are wrapped in double quotes
df = df.applymap(lambda x: f'"{x}"')

# Combine the last three columns into one, separated by '|'
df['combined_column'] = df.iloc[:, -3:].apply(lambda row: '|'.join(row), axis=1)

# Drop the last three original columns (if needed)
df = df.iloc[:, :-3]

# Save the modified DataFrame to a CSV with a custom separator (e.g., comma)
df.to_csv('output_file.csv', sep=',', index=False, quoting=1)  # quoting=1 ensures quotes around everything
