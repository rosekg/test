import pandas as pd

# Read the CSV files into DataFrames
master_df = pd.read_csv('master.csv')
delta1_df = pd.read_csv('delta1.csv')
delta_removed_df = pd.read_csv('delta_removed.csv')

# Set the initial flag value to "Not found"
master_df['flag'] = 'Not found'

# Update flag to "to be migrated" for records in delta1
master_df.loc[master_df['record_id'].isin(delta1_df['record_id']), 'flag'] = 'to be migrated'

# Update flag to "removed" for records in delta_removed
master_df.loc[master_df['record_id'].isin(delta_removed_df['record_id']), 'flag'] = 'removed'

# Update flag to "replace" for records in both delta1 and delta_removed
replace_ids = set(delta1_df['record_id']).intersection(set(delta_removed_df['record_id']))
master_df.loc[master_df['record_id'].isin(replace_ids), 'flag'] = 'replace'

# Save the updated master_df if needed
master_df.to_csv('updated_master.csv', index=False)
