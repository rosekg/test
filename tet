package com.example;

import com.example.consumer.KafkaJsonConsumer;
import com.example.producer.KafkaJsonProducer;

public class MainApp {
    public static void main(String[] args) {
        String bootstrapServers = "localhost:9092";
        String groupId = "my-group-id";
        String inputTopic = "input-topic";
        String outputTopic = "output-topic";

        KafkaJsonProducer producer = new KafkaJsonProducer(bootstrapServers, outputTopic);
        KafkaJsonConsumer consumer = new KafkaJsonConsumer(bootstrapServers, groupId, inputTopic);

        // Start consuming and processing messages
        new Thread(() -> {
            consumer.consumeAndProcess();
        }).start();

        // Example of sending a message
        producer.sendMessage("{\"key\": \"value\"}");

        Runtime.getRuntime().addShutdownHook(new Thread(() -> {
            producer.close();
        }));
    }
}
